<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Troubleshooting gargle auth • gargle</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Troubleshooting gargle auth">
<meta property="og:description" content="gargle">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gargle</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/non-interactive-auth.html">Non-interactive auth</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting gargle auth</a>
    </li>
    <li>
      <a href="../articles/auth-from-web.html">Auth when using R in the browser</a>
    </li>
    <li>
      <a href="../articles/get-api-credentials.html">How to get your own API credentials</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Blog posts</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2019/08/gargle-hello-world/">gargle’s debut on CRAN</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-lib/gargle/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Troubleshooting gargle auth</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/gargle/blob/master/vignettes/troubleshooting.Rmd"><code>vignettes/troubleshooting.Rmd</code></a></small>
      <div class="hidden name"><code>troubleshooting.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gargle</span>)</pre></body></html></div>
<div id="gargle_quiet" class="section level2">
<h2 class="hasAnchor">
<a href="#gargle_quiet" class="anchor"></a><code>gargle_quiet</code>
</h2>
<p>There is a package-wide option that controls gargle’s verbosity: <code>gargle_quiet</code>. The function <code><a href="../reference/gargle_options.html">gargle_quiet()</a></code> reveals the current value:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/gargle_options.html">gargle_quiet</a></span>()
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p>It defaults to <code>TRUE</code>, i.e. gargle defaults to being very quiet. This is because gargle is designed to try a bunch of auth methods (many of which will fail) and persist doggedly until one succeeds. If none succeeds, gargle tries to guide the user through auth or, in a non-interactive session, it throws an error.</p>
<p>If you need to see all those gory details, toggle the <code>gargle_quiet</code> option to <code>FALSE</code> and you’ll get much more output as gargle works through various auth approaches.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># save current value</span>
<span class="no">op</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">gargle_quiet</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="fu"><a href="../reference/gargle_options.html">gargle_quiet</a></span>()
<span class="co">#&gt; [1] FALSE</span>

<span class="co"># restore original value</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="no">op</span>)</pre></body></html></div>
</div>
<div id="gargle_oauth_sitrep" class="section level2">
<h2 class="hasAnchor">
<a href="#gargle_oauth_sitrep" class="anchor"></a><code>gargle_oauth_sitrep()</code>
</h2>
<p><code><a href="../reference/gargle_oauth_sitrep.html">gargle_oauth_sitrep()</a></code> provides an OAuth2 “situation report”.</p>
<p><code><a href="../reference/gargle_oauth_sitrep.html">gargle_oauth_sitrep()</a></code> is only relevant to OAuth2 user tokens. If you are using (or struggling to use) a service account token, Application Default Credentials, or credentials from the GCE metadata service, <code><a href="../reference/gargle_oauth_sitrep.html">gargle_oauth_sitrep()</a></code> isn’t going to help you figure out what’s going on.</p>
<p>Here is indicative output of <code><a href="../reference/gargle_oauth_sitrep.html">gargle_oauth_sitrep()</a></code>, for someone who has accepted the default OAuth cache location and has played with several APIs via gargle-using packages.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/gargle_oauth_sitrep.html">gargle_oauth_sitrep</a></span>()
<span class="co">#' gargle OAuth cache path:</span>
<span class="co">#' /Users/janedoe/.R/gargle/gargle-oauth</span>
<span class="co">#' </span>
<span class="co">#' 14 tokens found</span>
<span class="co">#' </span>
<span class="co">#' email                         app         scope                          hash...   </span>
<span class="co">#' ----------------------------- ----------- ------------------------------ ----------</span>
<span class="co">#' abcdefghijklm@gmail.com       thingy      ...bigquery, ...cloud-platform 128f9cc...</span>
<span class="co">#' buzzy@example.org             gargle-demo                                15acf95...</span>
<span class="co">#' stella@example.org            gargle-demo ...drive                       4281945...</span>
<span class="co">#' abcdefghijklm@gmail.com       gargle-demo ...drive                       48e7e76...</span>
<span class="co">#' abcdefghijklm@gmail.com       tidyverse                                  69a7353...</span>
<span class="co">#' nopqr@ABCDEFG.com             tidyverse   ...spreadsheets.readonly       86a70b9...</span>
<span class="co">#' abcdefghijklm@gmail.com       tidyverse   ...drive                       d9443db...</span>
<span class="co">#' nopqr@HIJKLMN.com             tidyverse   ...drive                       d9443db...</span>
<span class="co">#' nopqr@ABCDEFG.com             tidyverse   ...drive                       d9443db...</span>
<span class="co">#' stuvwzyzabcd@gmail.com        tidyverse   ...drive                       d9443db...</span>
<span class="co">#' efghijklmnopqrtsuvw@gmail.com tidyverse   ...drive                       d9443db...</span>
<span class="co">#' abcdefghijklm@gmail.com       tidyverse   ...drive.readonly              ecd11fa...</span>
<span class="co">#' abcdefghijklm@gmail.com       tidyverse   ...bigquery, ...cloud-platform ece63f4...</span>
<span class="co">#' nopqr@ABCDEFG.com             tidyverse   ...spreadsheets                f178dd8...</span></pre></body></html></div>
<p>It is relatively harmless to delete the folder serving as the OAuth cache. Or, if you have reason to believe one specific cached token is causing you pain, you could delete a specific token (an <code>.rds</code> file) from the cache. OAuth user tokens are meant to be perishable and replaceable.</p>
<p>If you choose to delete your cache (or a specific token), here is the fallout you can expect:</p>
<ul>
<li>You will need to re-auth (usually, meaning the browser dance) in projects that have been using the deleted tokens.</li>
<li>If you have <code>.R</code> or <code>.Rmd</code> files that you execute or render non-interactively, presumably with code such as <code>PKG_auth(email = "janedoe@example.com")</code>, those won’t run non-interactively until you’ve obtained and cached a token for the package and that identity (email) interactively once.</li>
<li>A specific Google user (email) can only have a certain number of OAuth tokens at a time (something like 50 per OAuth client). So, whenever you get a new token (as opposed to refreshing an existing token), there is the potential for it to invalidate an older token. This is unlikely to have any practical effect for a normal user, but can be noticeable for someone developing against a Google API or someone working from many different machines / caches.</li>
<li>If you have rigged some remote mission critical thing (e.g. a Shiny app or cron job) to use a user OAuth token (which is not a great idea), one day continued acquisition of new tokens in your normal interactive life will invalidate the mission critical token. Your thing (the Shiny app or cron job) will mysteriously fail because the OAuth token can’t be refreshed. Be prepared to deal with that periodically or, better yet, upgrade to a more robust strategy for <a href="https://gargle.r-lib.org/articles/non-interactive-auth.html">non-interactive auth</a>.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://jennybryan.org">Jennifer Bryan</a>, Craig Citro, <a href="http://hadley.nz">Hadley Wickham</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
